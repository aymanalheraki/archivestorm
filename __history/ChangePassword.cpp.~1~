//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop
#include "publicf.h"

#include "ChangePassword.h"
#include "Main.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma link "RzButton"
#pragma link "AeroButtons"
#pragma resource "*.dfm"
TFChangePassword *FChangePassword;
//---------------------------------------------------------------------------
__fastcall TFChangePassword::TFChangePassword(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------
void __fastcall TFChangePassword::btnSaveClick(TObject *Sender)
{
	if(FMain->vUserPassword == txtCurrentPassword->Text.Trim())
	{
		WideString strS = "UPDATE Users set userLogPassword='" + txtNewPassword->Text.Trim() + "' WHERE UserID=" + FMain->vUserID;
		CommandSQL(strS);

		AnsiString VChanges = "";
		VChanges = VChanges + " ÊÛííÑ ÇáÑÞã ÇáÓÑí ááãÓÊÎÏã : " +  FMain->vUserID  + "\n";
		//SaveLog("12","2",VChanges);

		ShowMessageA("Êã ÊÛííÑ ÇáÑÞã ÇáÓÑí ÈäÌÇÍ");
		Close();
	}
	else
	{
		ShowMessageA("ÇáÑÞã ÇáÍÇáí ÛíÑ ÕÍíÍ - íÑÌì ÇáÊÃßÏ ãä ÇáÑÞã ÇáÍÇáí æ ÅÚÇÏÉ ÇáãÍÇæáÉ");
        txtCurrentPassword->Text = "";
		txtCurrentPassword->SetFocus();
	}
}
//---------------------------------------------------------------------------
void __fastcall TFChangePassword::btnExitClick(TObject *Sender)
{
Close();
}
//---------------------------------------------------------------------------
void __fastcall TFChangePassword::FormCreate(TObject *Sender)
{
ChangeLanguage("E");
}
//---------------------------------------------------------------------------

