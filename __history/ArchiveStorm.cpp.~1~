//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop
#include <tchar.h>
//---------------------------------------------------------------------------
#include <Vcl.Styles.hpp>
#include <Vcl.Themes.hpp>
USEFORM("Main.cpp", FMain);
USEFORM("LogReport.cpp", FLogReport);
USEFORM("ProcAdd.cpp", FProcAdd);
USEFORM("ImageShow.cpp", FImageShow);
USEFORM("Help.cpp", FHelp);
USEFORM("login.cpp", Flogin);
USEFORM("RegisterPC.cpp", FRegisterPC);
USEFORM("UsersForm.cpp", FUsersForm);
USEFORM("UsersEdit.cpp", FUsersEdit);
USEFORM("wait.cpp", Fwait);
USEFORM("Vars.cpp", FVars);
USEFORM("Support.cpp", FSupport);
USEFORM("splash.cpp", Fsplash);
USEFORM("UsersAdd.cpp", FUsersAdd);
USEFORM("Types.cpp", FTypes);
USEFORM("Group.cpp", FGroup);
USEFORM("ArcDesc.cpp", FArcDesc);
USEFORM("arcAdd.cpp", FarcAdd);
USEFORM("ArcFiles.cpp", FArcFiles);
USEFORM("arcEdit.cpp", FarcEdit);
USEFORM("AddFiles.cpp", FAddFiles);
USEFORM("about.cpp", Fabout);
USEFORM("AlarmAdd.cpp", FAlarmAdd);
USEFORM("AddImages.cpp", FAddImages);
USEFORM("DateCorrection.cpp", FDateCorrection);
USEFORM("ChangePassword.cpp", FChangePassword);
USEFORM("ArcImages.cpp", FArcImages);
USEFORM("ArcPath.cpp", FArcPath);
USEFORM("ArcMain.cpp", FArcMain);
//---------------------------------------------------------------------------
int WINAPI _tWinMain(HINSTANCE, HINSTANCE, LPTSTR, int)
{

//ShowMessage(System::ParamStr(0));
//ShowMessage(System::ParamStr(1));

AnsiString mutexname="ArchiveStormAr";
HANDLE mutex = CreateMutex(NULL, TRUE, mutexname.c_str());
if( mutex )
{
  if( GetLastError() != ERROR_ALREADY_EXISTS )
  {
	try
	{
		Application->Initialize();
		Application->MainFormOnTaskBar = true;
		Application->CreateForm(__classid(TFMain), &FMain);
		Application->Run();
	}
	catch (Exception &exception)
	{
		Application->ShowException(&exception);
	}
	catch (...)
	{
		try
		{
			throw Exception("");
		}
		catch (Exception &exception)
		{
			Application->ShowException(&exception);
		}
	}
   }
   else
   {
		ShowMessage("Program is already running");
		CloseHandle(mutex);
	}
  }
	return 0;
}
//---------------------------------------------------------------------------
